<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome | Eastern Shore Auction House</title>
    <style>
        :root { --primary-color: #2563eb; --bg-color: #f3f4f6; --text-color: #1f2937; }
        body { font-family: -apple-system, sans-serif; background: var(--bg-color); color: var(--text-color); display: flex; flex-direction: column; align-items: center; min-height: 100vh; margin: 0; }
        
        header { width: 100%; background: #111827; color: white; padding: 40px 20px; text-align: center; }
        .brand-name { font-family: "Georgia", serif; font-size: 2.5rem; font-weight: bold; margin-bottom: 10px; }
        
        /* AUTH CARD */
        .auth-card { background: white; padding: 40px; margin-top: -30px; border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 90%; max-width: 400px; }
        .tabs { display: flex; margin-bottom: 20px; border-bottom: 2px solid #e5e7eb; }
        .tab { flex: 1; padding: 10px; text-align: center; cursor: pointer; font-weight: bold; color: #6b7280; }
        .tab.active { color: var(--primary-color); border-bottom: 2px solid var(--primary-color); }
        
        .form-group { margin-bottom: 15px; }
        input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        button.action-btn { width: 100%; padding: 12px; background: var(--primary-color); color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 1rem; }
        button.action-btn:hover { background: #1d4ed8; }
        
        .error-msg { color: #dc2626; font-size: 0.9rem; margin-bottom: 10px; display: none; text-align: center; }
        
        .catalog-link { margin-top: 30px; text-align: center; }
        .catalog-link a { color: #6b7280; text-decoration: none; }
    </style>
</head>
<body>

    <header>
        <div class="brand-name">Eastern Shore Auction House</div>
        <div>Member Login</div>
    </header>

    <div class="auth-card">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('login')">Log In</div>
            <div class="tab" onclick="switchTab('register')">Create Account</div>
        </div>

        <div id="errorMsg" class="error-msg"></div>

        <form id="loginForm" onsubmit="event.preventDefault(); handleLogin();">
            <div class="form-group"><input type="email" id="loginEmail" placeholder="Email Address" required></div>
            <div class="form-group"><input type="password" id="loginPass" placeholder="Password" required></div>
            <button type="submit" class="action-btn">Log In & Enter Auction</button>
        </form>

        <form id="registerForm" style="display:none;" onsubmit="event.preventDefault(); handleRegister();">
            <div class="form-group"><input type="text" id="regName" placeholder="Create Username (Visible to others)" required></div>
            <div class="form-group"><input type="email" id="regEmail" placeholder="Email Address" required></div>
            <div class="form-group"><input type="password" id="regPass" placeholder="Create Password (6+ chars)" required></div>
            <button type="submit" class="action-btn">Sign Up & Enter Auction</button>
        </form>
    </div>

    <div class="catalog-link">
        <p>Looking to sell? <a href="sell.html">Click here.</a></p>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // --- PASTE YOUR FIREBASE KEYS HERE ---
        const firebaseConfig = {
  apiKey: "AIzaSyCt0i8a7ZVRlNmSts9yM4uGwV7ghPU59rk",
  authDomain: "eastern-shore-auction.firebaseapp.com",
  databaseURL: "https://eastern-shore-auction-default-rtdb.firebaseio.com",
  projectId: "eastern-shore-auction",
  storageBucket: "eastern-shore-auction.firebasestorage.app",
  messagingSenderId: "771348898846",
  appId: "1:771348898846:web:3b6371e8f826747fdcba0f"
};

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // --- UI LOGIC ---
        window.switchTab = function(mode) {
            document.getElementById('errorMsg').style.display = 'none';
            if(mode === 'login') {
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('registerForm').style.display = 'none';
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.querySelectorAll('.tab')[1].classList.remove('active');
            } else {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'block';
                document.querySelectorAll('.tab')[0].classList.remove('active');
                document.querySelectorAll('.tab')[1].classList.add('active');
            }
        }

        // --- AUTH LOGIC ---
        
        // 1. LOGIN
        window.handleLogin = function() {
            const email = document.getElementById('loginEmail').value;
            const pass = document.getElementById('loginPass').value;
            const btn = document.querySelector('#loginForm button');
            
            btn.disabled = true; btn.innerText = "Verifying...";
            
            signInWithEmailAndPassword(auth, email, pass)
            .then((userCredential) => {
                // Success!
                window.location.href = "auction.html";
            })
            .catch((error) => {
                showError(error.message);
                btn.disabled = false; btn.innerText = "Log In & Enter Auction";
            });
        }

        // 2. REGISTER
        window.handleRegister = function() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const pass = document.getElementById('regPass').value;
            const btn = document.querySelector('#registerForm button');

            if(pass.length < 6) { showError("Password must be at least 6 characters"); return; }

            btn.disabled = true; btn.innerText = "Creating Account...";

            createUserWithEmailAndPassword(auth, email, pass)
            .then((userCredential) => {
                const user = userCredential.user;
                // Add the Username to the profile
                updateProfile(user, { displayName: name })
                .then(() => {
                    window.location.href = "auction.html";
                });
            })
            .catch((error) => {
                showError(error.message);
                btn.disabled = false; btn.innerText = "Sign Up & Enter Auction";
            });
        }

        function showError(msg) {
            const errDiv = document.getElementById('errorMsg');
            errDiv.style.display = 'block';
            // Clean up Firebase error messages to look nicer
            errDiv.innerText = msg.replace("Firebase: ", "").replace("auth/", "");
        }
    </script>
</body>
</html>